# Алгоритмы поиска решения для КТО.

Пусть $m_1, \dots, m_k$ — попарно взаимно простые натуральные числа, $m = m_1 \dots m_k$, $a_1, \dots, a_k \in \mathbb{Z}$.

+ Мы ищем такое $a$, что
$a \equiv a_1 \ (\text{mod} \ m_1), \dots, \ a \equiv a_k \ (\text{mod} \ m_k) \ (\ast)$
+ Будет использоваться алгоритм поиска обратного вычета, описанный выше.

### **Алгоритм 1**
+ Пусть $m'_i = m_1 \dots m_k / m_i$. Тогда $(m'_i, m_i) = 1$.
+ $b_i \in \{0, 1, \dots, m_i - 1\}$ — такое число, что $b_i \cdot m'_i \equiv 1 \ (\text{mod} \ m_i)$ 
(мы найдем $b_i$ с помощью алгоритма поиска обратного вычета).

### **Утверждение**
$a = a_1 b_1 m'_1 + a_2 b_2 m'_2 + \dots + a_k b_k m'_k$ — решение $(\ast)$.

#### **Доказательство**
Так как $m'_j \equiv 0 \ (\text{mod} \ m_i)$ при всех $j \neq i$, для любого $i \in \{1, \dots, k\}$:
$a \equiv a_i b_i m'_i \equiv a_i \ (\text{mod} \ m_i)$

+ Как сказано выше, все решения системы $(\ast)$ — это в точности числа, сравнимые с $a$ по модулю $m$.
+ Поделив $a$ на $m$ с остатком, мы найдем решение системы среди чисел $0, 1, \dots, m - 1$.

### **Алгоритм 2**
+ Индукцией по $s$ найдем $x_s$, удовлетворяющее первым $s$ сравнениям:
$x_s \equiv a_1 \ (\text{mod} \ m_1), \dots, \ x_s \equiv a_s \ (\text{mod} \ m_s)$
+ База $s = 1$ очевидна: подойдет $x_1 = a_1$.
+ Переход $s \rightarrow s + 1$:
    + Пусть $n_s = m_1 \dots m_s$.
    + Будем искать решение в виде $x_{s+1} = x_s + c_s n_s$.
    + Тогда $x_{s+1} - x_s \equiv 0 \ (\text{mod} \ m_j)$ для всех $j \in \{1, \dots, s\}$, поэтому $x_{s+1}$ удовлетворяет первым $s$ сравнениям.
    + Подберем $c_s$ так, чтобы
    $x_{s+1} \equiv a_{s+1} \ (\text{mod} \ m_{s+1})$
    $x_s + c_s n_s \equiv a_{s+1} \ (\text{mod} \ m_{s+1}) \iff c_s n_s \equiv a_{s+1} - x_s \ (\text{mod} \ m_{s+1}) \iff c_s \equiv (a_{s+1} - x_s) \cdot (n_s)^{-1} \ (\text{mod} \ m_{s+1})$
    + Так как $(n_s, m_{s+1}) = 1$, обратный вычет $(n_s)^{-1}$ существует и может быть найден с помощью описанного выше алгоритма.
    + Второй алгоритм решения КТО на первый взгляд сложнее, чем первый, но требует применения $k - 1$ алгоритмов поиска обратного вычета (а не $k$): мы не ищем обратный вычет по модулю $m_1$.
    + Поэтому целесообразно нумеровать модули так, чтобы $m_1$ оказался самым большим.
    