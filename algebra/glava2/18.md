# Мультипликативность функции Эйлера

### **Лемма 4**

Функция Эйлера мультипликативна, то есть, если $a, b \in \mathbb{N}$ взаимно просты, то $\phi(ab) = \phi(a) \phi(b)$.

#### **Доказательство**

+ Запишем числа от 1 до $ab$ в таблицу $a \times b$, так что в первой строке — числа от 1 до $a$, во второй — от $a + 1$ до $2a$, и т.д., в $b$-й строке — числа от $(b - 1)a + 1$ до $ba$.
+ Все числа в $i$-м столбце принадлежат одному вычету $i = i + a\mathbb{Z}$ по модулю $a$. Эти числа взаимно просты с $a$, если и только если $(i, a) = 1$.
+ Вычеркнем все столбцы с номерами $i$, не взаимно простыми с $a$. Останутся ровно $\phi(a)$ столбцов.
+ Все числа, взаимно простые с $ab$, должны быть взаимно простыми и с $a$, и они лежат в оставшихся $\phi(a)$ столбцах.
+ Рассмотрим любой оставшийся столбец, пусть числа в нем имеют вид $j, a + j, \dots, (b - 1)a + j$. Эти числа образуют ПСВ (mod $b$) в силу [Теоремы 13](15.md#теорема-13), так как получены из ПСВ $0, 1, \dots, b - 1$ умножением на $a$, взаимно простое с $b$, и прибавлением $j$: $0 \to j, 1 \to a + j, \dots, b - 1 \to (b - 1)a + j$.
+ Значит, среди чисел $j, a + j, \dots, (b - 1)a + j$ ровно $\phi(b)$ взаимно простых с $b$. Остальные числа точно не взаимно просты с $ab$, вычеркнем их.
+ Оставшиеся $\phi(a)\phi(b)$ чисел взаимно просты и с $a$, и с $b$, а значит, взаимно просты с $ab$. Значит, осталось ровно $\phi(ab)$ чисел (все числа от 1 до $ab$, взаимно простые с $ab$).

### **Лемма 5**

Если $p \in \mathbb{P}$, $n \in \mathbb{N}$, то $\phi(p^n) = p^n - p^{n-1}$.

#### **Доказательство**

+ Посчитаем количество чисел от 1 до $p^n$, не взаимно простых с $p^n$.
+ Пусть $(a, p^n) = d > 1$. Так как $p^n : d$, должно быть $d : p$.
+ Следовательно, числа от 1 до $p^n$, не взаимно простые с $p^n$, — это в точности числа от 1 до $p^n$, кратные $p$. Их количество равно $p^{n-1}$.
